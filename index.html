<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Management</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    form {
      margin-bottom: 20px;
      padding: 10px;
      border: 1px solid #ccc;
      width: 300px;
    }
    input {
      display: block;
      margin-bottom: 10px;
      width: 95%;
      padding: 5px;
    }
    button {
      padding: 5px 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
  </style>
</head>
<body>
  <h2>Add New Student</h2>
  <form id="studentForm">
    <input type="text" name="roll" placeholder="Roll Number" required>
    <input type="text" name="enrol" placeholder="Enrolment Number" required>
    <input type="text" name="name" placeholder="Student Name" required>
    <input type="number" name="hindi" placeholder="Hindi Marks" required>
    <input type="number" name="english" placeholder="English Marks" required>
    <input type="number" name="maths" placeholder="Maths Marks" required>
    <input type="number" name="gk" placeholder="GK Marks" required>
    <button type="submit">Add Student</button>
  </form>

  <h2>All Students</h2>
  <table id="studentTable">
    <thead>
      <tr>
        <th>Roll Number</th>
        <th>Enrolment Number</th>
        <th>Student Name</th>
        <th>Hindi</th>
        <th>English</th>
        <th>Maths</th>
        <th>GK</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbykVQeKo_o4_EevyUafzBKvbApDkV8vU95kyLGap64JRUOThOC2EENWpmd-iGlhmn2y8A/exec";

    // Fetch and display data
    async function fetchStudents() {
      const response = await fetch(scriptURL);
      const data = await response.json();

      const tbody = document.querySelector("#studentTable tbody");
      tbody.innerHTML = "";

      data.forEach(student => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${student["Roll Number"]}</td>
          <td>${student["Enrolment Number"]}</td>
          <td>${student["Student Name"]}</td>
          <td>${student["Hindi"]}</td>
          <td>${student["English"]}</td>
          <td>${student["Maths"]}</td>
          <td>${student["GK"]}</td>
        `;
        tbody.appendChild(row);
      });
    }

    // Submit form to add student
    document.getElementById("studentForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const form = e.target;
      const formData = {
        "Roll Number": form.roll.value.trim(),
        "Enrolment Number": form.enrol.value.trim(),
        "Student Name": form.name.value.trim(),
        "Hindi": form.hindi.value.trim(),
        "English": form.english.value.trim(),
        "Maths": form.maths.value.trim(),
        "GK": form.gk.value.trim()
      };

      const response = await fetch(scriptURL, {
        method: "POST",
        body: JSON.stringify(formData),
        headers: {
          "Content-Type": "application/json"
        }
      });

      const result = await response.json();
      if (result.status === "success") {
        alert("Student added successfully!");
        form.reset();
        fetchStudents(); // Refresh table
      } else {
        alert("Error: " + result.message);
      }
    });

    window.onload = fetchStudents;
  </script>
</body>
</html>
